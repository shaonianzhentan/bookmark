"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[334],{73788:function(he,b,a){a.r(b),a.d(b,{default:function(){return ie}});var J=a(3849),j=a.n(J),x=a(93236),N=a(94002),A=a(25197),U=a(25422),W=a(84329),D={PageHeader:"PageHeader___QGlLD",CommentList:"CommentList___Du__g"},K=a(65039),V=a.n(K),z=a(11898),Q=a.n(z);function Z(c,o){var t=c.querySelector(o);if(t)return t;if(c.children.length>0)for(var r=c.children,n=0,i=r.length;n<i;n++){var u=Z(r[n],o);if(u)return u}if(c.renderRoot){if(t=c.renderRoot.querySelector(o),t)return t;if(c.renderRoot.children.length>0)for(var s=c.renderRoot.children,h=0,g=s.length;h<g;h++){var d=Z(s[h],o);if(d)return d}}}var X=function(){function c(){V()(this,c)}return Q()(c,[{key:"homeassistant",get:function(){return parent.document.querySelector("home-assistant")}},{key:"hass",get:function(){return this.homeassistant.hass}},{key:"jsonClone",value:function(t){return JSON.parse(JSON.stringify(t))}},{key:"httpPost",value:function(t,r){return this.hass.fetchWithAuth(t,{method:"POST",body:JSON.stringify(r)}).then(function(n){return n.json()})}},{key:"httpPut",value:function(t,r){return this.hass.fetchWithAuth(t,{method:"PUT",body:JSON.stringify(r)}).then(function(n){return n.json()})}},{key:"httpGet",value:function(t){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{t:Date.now()},n=[],i=0,u=Object.entries(r);i<u.length;i++){var s=j()(u[i],2),h=s[0],g=s[1];n.push("".concat(h,"=").concat(g))}return n.length>0&&(t+="?"+n.join("&")),this.hass.fetchWithAuth(t).then(function(d){return d.json()})}},{key:"httpDelete",value:function(t,r){return this.hass.fetchWithAuth(t,{method:"DELETE",body:JSON.stringify(r)}).then(function(n){return n.json()})}},{key:"fireEvent",value:function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=parent,u=new i.Event(t,{bubbles:!0,cancelable:!1,composed:!0});u.detail=r,n||(n=Z(i.document,"home-assistant-main")),n.dispatchEvent(u)}},{key:"fullScreen",value:function(){var t=Z(parent.document,"hass-subpage"),r=t.querySelector("iframe"),n=t.shadowRoot.querySelector(".toolbar");t.shadowRoot.querySelector(".content").style.height="100vh",r.style.position="absolute",n.style.display="none",r.style.top="0",r.style.height="100%"}},{key:"hassToggleMenu",value:function(){this.fireEvent("hass-toggle-menu")}}]),c}(),B=new X;B.fullScreen();var p=B,H=a(6528),P=a(14046),F=a(98874),Y=a(22398),M=a(82258),$=a(5962),w=a(89256),q=a(49203),e=a(62086),_=function(o){var t=(0,x.createRef)(),r=(0,x.useState)(!1),n=j()(r,2),i=n[0],u=n[1],s=o.onOk,h=o.options,g=function(){var v;(v=t.current)===null||v===void 0||v.submit()},d=function(v){p.httpPost("/api/bookmark",v).then(function(y){s(y),u(!1),A.ZP.info("\u4FDD\u5B58\u6210\u529F")})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(H.Z,{destroyOnClose:!0,title:"\u65B0\u589E\u4E66\u7B7E",width:"100%",visible:i,onOk:g,onCancel:function(){return u(!1)},children:(0,e.jsxs)(P.Z,{ref:t,name:"normal_login",className:"login-form",initialValues:{remember:!0},onFinish:d,children:[(0,e.jsx)(P.Z.Item,{name:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0"}],children:(0,e.jsx)(F.Z,{prefix:(0,e.jsx)($.Z,{}),placeholder:"\u540D\u79F0"})}),(0,e.jsx)(P.Z.Item,{name:"url",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7F51\u5740"}],children:(0,e.jsx)(F.Z,{prefix:(0,e.jsx)(w.Z,{}),placeholder:"\u7F51\u5740"})}),(0,e.jsx)(P.Z.Item,{name:"category",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5206\u7C7B"}],children:(0,e.jsx)(Y.Z,{options:h,placeholder:"\u5206\u7C7B",filterOption:function(v,y){return y.value.toUpperCase().indexOf(v.toUpperCase())!==-1}})})]})}),(0,e.jsx)(M.Z,{shape:"circle",icon:(0,e.jsx)(q.Z,{}),onClick:function(){return u(!0)}})]})},ee=_,te=a(74550),T=a(43490),ne=a(40841),ae=a(61929),re=function(o){var t=o.source,r=o.className,n=o.deleteClick,i=function(s){p.httpPut("/api/bookmark",{url:s,key:"time",value:Date.now()})};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(T.ZP,{className:r,header:"".concat(t.length," \u6761\u4E66\u7B7E"),itemLayout:"horizontal",dataSource:t,renderItem:function(s){return(0,e.jsx)(T.ZP.Item,{actions:n?[(0,e.jsx)("a",{onClick:function(){return n(s.url)},children:"\u5220\u9664"},"list-loadmore-more")]:[],children:(0,e.jsx)(T.ZP.Item.Meta,{avatar:(0,e.jsx)(ne.C,{src:"https://0x3.com/icon?host=".concat(s.hostname)}),title:(0,e.jsx)("a",{target:"_blank",href:s.url,onClick:function(){return i(s.url)},children:s.url}),description:[(0,e.jsx)("a",{target:"_blank",href:s.origin,onClick:function(){return i(s.url)},children:s.host}),(0,e.jsx)(ae.Z,{type:"vertical"}),(0,e.jsx)("span",{children:s.name})]})})}})})},I=re,oe=function(o){var t=(0,x.useState)(!1),r=j()(t,2),n=r[0],i=r[1],u=o.source,s=(0,x.useState)([]),h=j()(s,2),g=h[0],d=h[1],C=function(y){var k=y.target.value;d(u.filter(function(O){return O.name.toLocaleLowerCase().includes(k)||O.url.toLocaleLowerCase().includes(k)}))};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(H.Z,{destroyOnClose:!0,title:"\u641C\u7D22",width:"100%",style:{top:5},visible:n,onCancel:function(){return i(!1)},footer:null,children:[(0,e.jsx)(F.Z,{placeholder:"\u8BF7\u8F93\u5165\u5173\u952E\u8BCD\u641C\u7D22",onInput:C}),(0,e.jsx)(I,{source:g})]}),(0,e.jsx)(M.Z,{shape:"circle",icon:(0,e.jsx)(te.Z,{}),onClick:function(){return i(!0)}})]})},se=oe,R=N.Z.TabPane,E=new Array,ue=function(){var o=(0,x.useState)(""),t=j()(o,2),r=t[0],n=t[1],i=(0,x.useState)([]),u=j()(i,2),s=u[0],h=u[1],g=(0,x.useState)([]),d=j()(g,2),C=d[0],v=d[1],y=function(f){f.sort(function(l,S){var L=l.time||0,G=S.time||0,ce=L>G?-1:L<G?1:0;return ce}),E=f.map(function(l){var S=new URL(l.url),L=l.time?new Date(l.time).toLocaleString():"";return{host:S.host,hostname:S.hostname,name:l.name,url:l.url,origin:S.origin,category:l.category,time:L}}),v(Array.from(new Set(f.map(function(l){return l.category})))),k(r)};(0,x.useEffect)(function(){p.httpGet("/api/bookmark").then(function(m){var f;y(m),(f=document.querySelector(".ant-page-header-heading-left"))===null||f===void 0||f.addEventListener("click",function(l){p.hassToggleMenu()},!1)})},[]);var k=function(f){n(f),h(p.jsonClone(f?E.filter(function(l){return l.category===f}):E))},O=function(f){y(f)},le=function(f){var l;!((l=top)!==null&&l!==void 0&&l.confirm("\u786E\u5B9A\u5220\u9664\uFF1F"))||p.httpDelete("/api/bookmark",{url:f}).then(function(S){y(S),A.ZP.info("\u5220\u9664\u6210\u529F")})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(U.Z,{offsetTop:0,children:(0,e.jsx)(W.Z,{className:D.PageHeader,avatar:{src:"https://www.home-assistant.io/images/favicon-192x192.png"},title:"\u4E66\u7B7E",extra:[(0,e.jsx)(ee,{options:C.map(function(m){return{value:m}}),onOk:O},"add"),(0,e.jsx)(se,{source:E},"search")]})}),(0,e.jsxs)(N.Z,{className:D.tabs,activeKey:r,centered:!0,onChange:k,children:[(0,e.jsx)(R,{tab:"\u5168\u90E8"},""),C.map(function(m){return(0,e.jsx)(R,{tab:m},m)})]}),(0,e.jsx)(I,{className:D.CommentList,source:s,deleteClick:le})]})},ie=ue}}]);
