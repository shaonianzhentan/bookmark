"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[371],{30308:function(he,B,r){r.r(B),r.d(B,{default:function(){return ie}});var G=r(5574),p=r.n(G),x=r(62435),N=r(96619),D=r(16536),K=r(86396),U=r(80547),T={PageHeader:"PageHeader___KMqpB",CommentList:"CommentList___JYXSf"},W=r(12444),V=r.n(W),z=r(72004),X=r.n(z);function Z(f,s){var t=f.querySelector(s);if(t)return t;if(f.children.length>0)for(var o=f.children,n=0,l=o.length;n<l;n++){var i=Z(o[n],s);if(i)return i}if(f.renderRoot){if(t=f.renderRoot.querySelector(s),t)return t;if(f.renderRoot.children.length>0)for(var d=f.renderRoot.children,a=0,c=d.length;a<c;a++){var u=Z(d[a],s);if(u)return u}}}var Y=function(){function f(){V()(this,f)}return X()(f,[{key:"homeassistant",get:function(){return parent.document.querySelector("home-assistant")}},{key:"hass",get:function(){return this.homeassistant.hass}},{key:"jsonClone",value:function(t){return JSON.parse(JSON.stringify(t))}},{key:"httpPost",value:function(t,o){return this.hass.fetchWithAuth(t,{method:"POST",body:JSON.stringify(o)}).then(function(n){return n.json()})}},{key:"httpPut",value:function(t,o){return this.hass.fetchWithAuth(t,{method:"PUT",body:JSON.stringify(o)}).then(function(n){return n.json()})}},{key:"httpGet",value:function(t){for(var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{t:Date.now()},n=[],l=0,i=Object.entries(o);l<i.length;l++){var d=p()(i[l],2),a=d[0],c=d[1];n.push("".concat(a,"=").concat(c))}return n.length>0&&(t+="?"+n.join("&")),this.hass.fetchWithAuth(t).then(function(u){return u.json()})}},{key:"httpDelete",value:function(t,o){return this.hass.fetchWithAuth(t,{method:"DELETE",body:JSON.stringify(o)}).then(function(n){return n.json()})}},{key:"fireEvent",value:function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,l=parent,i=new l.Event(t,{bubbles:!0,cancelable:!1,composed:!0});i.detail=o,n||(n=Z(l.document,"home-assistant-main")),n.dispatchEvent(i)}},{key:"fullScreen",value:function(){var t=Z(parent.document,"hass-subpage"),o=t.querySelector("iframe"),n=t.shadowRoot.querySelector(".toolbar");t.shadowRoot.querySelector(".content").style.height="100vh",o.style.position="absolute",n.style.display="none",o.style.top="0",o.style.height="100%"}},{key:"hassToggleMenu",value:function(){this.fireEvent("hass-toggle-menu")}}]),f}(),A=new Y;A.fullScreen();var j=A,M=r(67040),P=r(95239),L=r(2831),Q=r(49288),H=r(71577),$=r(38545),w=r(10524),q=r(24969),e=r(86074),_=function(s){var t=(0,x.createRef)(),o=(0,x.useState)(!1),n=p()(o,2),l=n[0],i=n[1],d=s.onOk,a=s.options,c=function(){var m;(m=t.current)===null||m===void 0||m.submit()},u=function(m){j.httpPost("/api/bookmark",m).then(function(y){d(y),i(!1),D.ZP.info("\u4FDD\u5B58\u6210\u529F")})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(M.Z,{destroyOnClose:!0,title:"\u65B0\u589E\u4E66\u7B7E",width:"100%",visible:l,onOk:c,onCancel:function(){return i(!1)},children:(0,e.jsxs)(P.Z,{ref:t,name:"normal_login",className:"login-form",initialValues:{remember:!0},onFinish:u,children:[(0,e.jsx)(P.Z.Item,{name:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0"}],children:(0,e.jsx)(L.Z,{prefix:(0,e.jsx)($.Z,{}),placeholder:"\u540D\u79F0"})}),(0,e.jsx)(P.Z.Item,{name:"url",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7F51\u5740"}],children:(0,e.jsx)(L.Z,{prefix:(0,e.jsx)(w.Z,{}),placeholder:"\u7F51\u5740"})}),(0,e.jsx)(P.Z.Item,{name:"category",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5206\u7C7B"}],children:(0,e.jsx)(Q.Z,{options:a,placeholder:"\u5206\u7C7B",filterOption:function(m,y){return y.value.toUpperCase().indexOf(m.toUpperCase())!==-1}})})]})}),(0,e.jsx)(H.Z,{shape:"circle",icon:(0,e.jsx)(q.Z,{}),onClick:function(){return i(!0)}})]})},ee=_,te=r(68795),F=r(1203),ne=r(86871),ae=r(40877),re=function(s){var t=s.source,o=s.className,n=s.deleteClick,l=function(a){j.httpPut("/api/bookmark",{url:a,key:"time",value:Date.now()})},i=function(a){var c="unique-id-clipboard-copyText",u=document.getElementById(c);u||(u=document.createElement("input"),u.id=c,u.style.cssText="position:absolute;left:-9999px",document.body.appendChild(u)),u.value=a,u.select(),u.setSelectionRange(0,u.value.length),document.execCommand("copy"),D.ZP.success("\u590D\u5236\u6210\u529F")};return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(F.ZP,{className:o,header:"".concat(t.length," \u6761\u4E66\u7B7E"),itemLayout:"horizontal",dataSource:t,renderItem:function(a){return(0,e.jsx)(F.ZP.Item,{actions:n?[(0,e.jsx)("a",{onClick:function(){return n(a.url)},children:"\u5220\u9664"},"list-loadmore-more")]:[],children:(0,e.jsx)(F.ZP.Item.Meta,{avatar:(0,e.jsx)(ne.C,{src:"https://0x3.com/icon?host=".concat(a.hostname)}),title:(0,e.jsx)("a",{target:"_blank",href:a.url,onClick:function(){return l(a.url)},onDoubleClick:function(){return i(a.url)},children:a.url}),description:[(0,e.jsx)("a",{target:"_blank",href:a.origin,onClick:function(){return l(a.url)},onDoubleClick:function(){return i(a.url)},children:a.host}),(0,e.jsx)(ae.Z,{type:"vertical"}),(0,e.jsx)("span",{children:a.name})]})})}})})},I=re,oe=function(s){var t=(0,x.useState)(!1),o=p()(t,2),n=o[0],l=o[1],i=s.source,d=(0,x.useState)([]),a=p()(d,2),c=a[0],u=a[1],C=function(y){var k=y.target.value;u(i.filter(function(O){return O.name.toLocaleLowerCase().includes(k)||O.url.toLocaleLowerCase().includes(k)}))};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(M.Z,{destroyOnClose:!0,title:"\u641C\u7D22",width:"100%",style:{top:5},visible:n,onCancel:function(){return l(!1)},footer:null,children:[(0,e.jsx)(L.Z,{placeholder:"\u8BF7\u8F93\u5165\u5173\u952E\u8BCD\u641C\u7D22",onInput:C}),(0,e.jsx)(I,{source:c})]}),(0,e.jsx)(H.Z,{shape:"circle",icon:(0,e.jsx)(te.Z,{}),onClick:function(){return l(!0)}})]})},se=oe,R=N.Z.TabPane,E=new Array,ue=function(){var s=(0,x.useState)(""),t=p()(s,2),o=t[0],n=t[1],l=(0,x.useState)([]),i=p()(l,2),d=i[0],a=i[1],c=(0,x.useState)([]),u=p()(c,2),C=u[0],m=u[1],y=function(v){v.sort(function(h,S){var b=h.time||0,J=S.time||0,ce=b>J?-1:b<J?1:0;return ce}),E=v.map(function(h){var S=new URL(h.url),b=h.time?new Date(h.time).toLocaleString():"";return{host:S.host,hostname:S.hostname,name:h.name,url:h.url,origin:S.origin,category:h.category,time:b}}),m(Array.from(new Set(v.map(function(h){return h.category})))),k(o)};(0,x.useEffect)(function(){j.httpGet("/api/bookmark").then(function(g){var v;y(g),(v=document.querySelector(".ant-page-header-heading-left"))===null||v===void 0||v.addEventListener("click",function(h){j.hassToggleMenu()},!1)})},[]);var k=function(v){n(v),a(j.jsonClone(v?E.filter(function(h){return h.category===v}):E))},O=function(v){y(v)},le=function(v){var h;(h=top)!==null&&h!==void 0&&h.confirm("\u786E\u5B9A\u5220\u9664\uFF1F")&&j.httpDelete("/api/bookmark",{url:v}).then(function(S){y(S),D.ZP.info("\u5220\u9664\u6210\u529F")})};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(K.Z,{offsetTop:0,children:(0,e.jsx)(U.Z,{className:T.PageHeader,avatar:{src:"https://www.home-assistant.io/images/favicon-192x192.png"},title:"\u4E66\u7B7E",extra:[(0,e.jsx)(ee,{options:C.map(function(g){return{value:g}}),onOk:O},"add"),(0,e.jsx)(se,{source:E},"search")]})}),(0,e.jsxs)(N.Z,{className:T.tabs,activeKey:o,centered:!0,onChange:k,children:[(0,e.jsx)(R,{tab:"\u5168\u90E8"},""),C.map(function(g){return(0,e.jsx)(R,{tab:g},g)})]}),(0,e.jsx)(I,{className:T.CommentList,source:d,deleteClick:le})]})},ie=ue}}]);
